<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_student_form" model="ir.ui.view">
        <field name="name">student.student.form</field>
        <field name="model">student.student</field>
        <field name="arch" type="xml">
            <form>
                <style>
                    .student-btn-form {
                    background-color: #69a30b;
                    color: black !important;
                    }
                </style>
                <header>
                    <button name="act_confirm" type="object" string="Confirm" class="oe_highlight"
                            invisible="state != 'draft'"/>
                    <button name="act_send_welcome_email" type="object" string="Send Mail" class="oe_highlight"/>
                    <button name="action_generate_form_link" string="Student Details Form" type="object"
                            class="student-btn-form"/>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_get_discount_record" type="object" icon="fa-credit-card"
                                class="oe_stat_button">
                            <field name="discount_count" widget="statinfo" string="Discount"/>
                        </button>
                    </div>
                    <div style="width:100%;" class="row align-items-center">
                        <div class="col-4 col-lg-2" style="text-align-last: center;">
                            <field name="photo" widget="image" class="oe_left oe_avatar"
                                   style="margin-right: 30px !important;"/>
                        </div>
                        <div class="mb16 col-8 col-lg-10 px-0">
                            <div class="row">
                                <h2 class="col-12 col-lg-10">

                                    <table>
                                        <tr>
                                            <!--                                                <td style="padding-right:10px;">-->
                                            <td style="padding-right:10px;">
                                                <field name="first_name" placeholder="First Name"/>
                                            </td>
                                            <td style="padding-right:10px;">
                                                <field name="last_name" placeholder="Last Name"/>
                                            </td>
                                            <!--                                                    <field name="first_name" placeholder="First Name"-->
                                            <!--                                                           string="First Name" required="1"/>-->
                                            <!--                                                    <field name="last_name" placeholder="Last Name" string="Last Name"-->
                                            <!--                                                           required="1"/>-->
                                            <field name="name" required="1" placeholder="Student Name" invisible="1"
                                            />
                                            <!--                                                </td>-->
                                        </tr>

                                    </table>

                                </h2>
                            </div>
                            <group>
                                <group>
                                    <field name="form_token" invisible="1"/>
                                    <field name="course_id" string="Course"/>
                                    <field name="admission_no" string="Admission No." placeholder="Admission Number"/>
                                    <field name="mobile" placeholder="Mobile Number"/>
                                    <field name="whatsapp"/>
                                    <field name="email" required="1" placeholder="Email Address"/>
                                    <field name="user_id" string="Admission Officer" widget="many2one_avatar_user"/>

                                </group>
                            </group>
                        </div>
                    </div>

                    <notebook>
                        <page string="Personal Information" name="personal_information">
                            <group>
                                <group>
                                    <field name="branch" string="Campus" options="{'no_create':True}"/>
                                    <field name="branch_code" invisible="1"/>
                                    <field name="is_it_required_university" invisible="1"/>
                                    <field name="is_it_required_second_language" invisible="1"/>
                                    <field name="university" invisible="is_it_required_university == 0"/>
                                    <field name="second_language" invisible="is_it_required_second_language == 0"/>
                                    <field name="batch_id"/>
                                    <!--                                    <field name="payment_scheme"/>-->
                                    <field name="installment_count" invisible="payment_scheme != 'installment'"/>
                                </group>
                                <group string="Father's Details">
                                    <field name="father_name"/>
                                    <field name="father_mail"/>
                                    <!--                                    <field name="father_age"/>-->
                                    <field name="father_occupation"/>
                                    <field name="father_occupation_location"/>
                                    <field name="father_contact"/>
                                </group>
                                <group string="Mother's Details">
                                    <field name="mother_name"/>
                                    <field name="mother_mail"/>
                                    <!--                                    <field name="mother_age"/>-->
                                    <field name="mother_occupation"/>
                                    <field name="mother_occupation_location"/>
                                    <field name="mother_contact"/>
                                </group>
                            </group>
                        </page>
                        <page string="Address Information">
                            <group>
                                <group string="Communication Address">
                                    <field name="comm_flat_no"/>
                                    <field name="comm_street"/>
                                    <field name="comm_post_office"/>
                                    <field name="comm_district"/>
                                    <field name="comm_state"/>
                                    <field name="comm_pincode"/>
                                </group>
                                <group string="Permanent Address">
                                    <field name="same_as_community"/>
                                    <field name="perm_flat_no"/>
                                    <field name="perm_street"/>
                                    <field name="perm_post_office"/>
                                    <field name="perm_district"/>
                                    <field name="perm_state"/>
                                    <field name="perm_pincode"/>
                                </group>
                            </group>
                        </page>
                        <page string="Academic Records">
                            <group>
                                <group>
                                    <field name="enrollment_date"/>
                                    <field name="academic_year"/>
                                    <field name="mode_of_study"/>
                                    <field name="course_id" options="{'no_create': True, 'no_create_edit': True}"/>
                                    <field name="course_code" invisible="1"/>
                                    <field name="course_type"/>
                                    <field name="semester_count"/>
                                </group>
                            </group>
                            <field name="academic_records_ids">
                                <tree editable="bottom">
                                    <field name="exam_passed"/>
                                    <field name="institution"/>
                                    <field name="location"/>
                                    <field name="year"/>
                                    <field name="percentage"/>
                                </tree>
                            </field>

                        </page>
                        <page string="Fee Management">
                            <group>
                                <group>
                                    <label for="fee_type"/>
                                    <div class="o_row">
                                        <field name="fee_type"/>
                                        <button name="act_discount_request"
                                                type="object"
                                                string="Discount Request"
                                                invisible="fee_type != 'discount'"
                                                class="oe_highlight"/>
                                    </div>
                                    <field name="payment_scheme"/>
                                    <field name="discount_type" invisible="fee_type != 'discount'"/>
                                    <field name="discount_requested_by" invisible="fee_type != 'discount'"/>
                                    <field name="discount_approved_by" invisible="fee_type != 'discount'"/>
                                </group>

                                <group>
                                    <field name="course_fee" string="Course Fee"/>
                                    <field name="discount_fee" invisible="fee_type != 'discount'" readonly="1"/>
                                    <field name="total_fee"/>
                                    <field name="paid_amount"/>
                                    <field name="pending_amount"/>
                                    <field name="next_payment_date"/>
                                </group>
                            </group>

                            <!-- Add notebook for child pages -->
                            <notebook>
                                <page string="Payment Details" name="payment_details">

                                    <field name="fee_payment_ids">
                                        <tree editable="bottom">
                                            <field name="payment_date"/>
                                            <field name="amount"/>
                                            <field name="payment_method"/>
                                            <field name="reference"/>
                                            <field name="installment_number"/>
                                            <field name="notes"/>
                                        </tree>
                                    </field>

                                </page>

                                <page name="semester_fee_details" string="Semester Fee Details" invisible="course_type != 'degree'">
                                    <field name="semester_records_ids" string="Semester Details">
                                        <tree editable="bottom">
                                            <field name="name"/>
                                            <field name="semester"/>
                                            <field name="fee_amount"/>
                                            <field name="paid_amount"/>
                                            <field name="balance_amount"/>
                                            <field name="due_date"/>
                                            <field name="status" widget='badge' decoration-success="status == 'paid'"
                                                   decoration-info="status == 'draft'"
                                                   decoration-warning="status == 'partial'"/>
                                        </tree>
                                    </field>
                                </page>
                            </notebook>
                        </page>

                        <page string="Personal Documents">
                            <group>
                                <group>
                                    <field name="photo"/>
                                    <field name="sslc_certificate"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                    <field name="activity_ids" widget="mail_activity"/>
                </div>
            </form>
        </field>
    </record>

    <record id="ir_sequence_student_student" model="ir.sequence">
        <field name="name">Admission Numbers</field>
        <field name="code">student.student</field>
        <field name="prefix">CB</field>
        <field name="padding">4</field>
        <field name="number_next">1</field>
        <field name="number_increment">1</field>
        <field name="company_id" eval="False"/>
    </record>

    <record id="view_student_tree" model="ir.ui.view">
        <field name="name">student.student.tree</field>
        <field name="model">student.student</field>
        <field name="arch" type="xml">
            <tree>
                <field name="admission_no"/>
                <field name="name"/>
                <field name="mobile" placeholder="Mobile Number"/>
                <field name="course_id"/>
                <field name="batch_id"/>
                <field name="user_id" string="Admission Officer" optional="show"/>
                <field name="total_fee" sum="Total"/>
                <field name="paid_amount" sum="Paid"/>
                <field name="pending_amount" sum="Pending"/>
                <field name="payment_scheme"/>
                <field name="next_payment_date"/>
                <field name="state" widget="badge" decoration-success="state == 'confirmed'"
                       decoration-info="state == 'draft'"/>
            </tree>
        </field>
    </record>

    <record id="action_student" model="ir.actions.act_window">
        <field name="name">Students</field>
        <field name="res_model">student.student</field>
        <field name="view_mode">tree,form</field>
    </record>

    <record id="action_courses" model="ir.actions.act_window">
        <field name="name">Courses</field>
        <field name="res_model">product.product</field>
        <field name="view_mode">kanban,tree,form</field>
    </record>

    <menuitem id="menu_student_root"
              name="Student Management"
              web_icon="student_management,static/description/icon.png"
              sequence="10"/>

    <menuitem id="menu_student"
              name="Students"
              parent="menu_student_root"
              action="action_student"
              sequence="1"/>

    <menuitem id="menu_courses"
              name="Courses"
              parent="menu_student_root"
              action="action_courses"
              sequence="2"/>
</odoo>
